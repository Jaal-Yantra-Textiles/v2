/* JYT Analytics v1.0.0 | Privacy-focused tracking | https://jaalyantra.in */
!function(){"use strict";const t=document.currentScript,e=t.getAttribute("data-website-id"),n=`${t.getAttribute("data-api-url")||"https://v3.jaalyantra.com"}/web/analytics/track`;if(!e)return void console.warn("[Analytics] Missing data-website-id attribute");function i(){const t="jyt_visitor_id";let e=localStorage.getItem(t);return e||(e="visitor_"+Math.random().toString(36).substring(2)+Date.now().toString(36),localStorage.setItem(t,e)),e}function o(){const t="jyt_session_id",e="jyt_session_timestamp",n=Date.now();n-parseInt(sessionStorage.getItem(e)||"0")>18e5&&sessionStorage.removeItem(t);let i=sessionStorage.getItem(t);return i||(i="session_"+Math.random().toString(36).substring(2)+Date.now().toString(36),sessionStorage.setItem(t,i)),sessionStorage.setItem(e,n.toString()),i}function a(){r({website_id:e,event_type:"pageview",pathname:window.location.pathname,referrer:document.referrer||void 0,visitor_id:i(),session_id:o()})}function s(t,n){r({website_id:e,event_type:"custom_event",event_name:t,pathname:window.location.pathname,visitor_id:i(),session_id:o(),metadata:n||void 0})}function r(t){if(navigator.sendBeacon){const e=new Blob([JSON.stringify(t)],{type:"application/json"});navigator.sendBeacon(n,e)}else fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),keepalive:!0}).catch(function(t){console&&console.error&&console.error("[Analytics] Failed to send event:",t)})}a();let c=window.location.pathname;function l(){const t=window.location.pathname;t!==c&&(c=t,a())}const d=history.pushState,p=history.replaceState;history.pushState=function(){d.apply(this,arguments),l()},history.replaceState=function(){p.apply(this,arguments),l()},window.addEventListener("popstate",l);let u=null;function v(){u&&clearInterval(u),u=setInterval(()=>{"visible"===document.visibilityState&&s("heartbeat",{page:window.location.pathname,active:!0})},3e4)}function g(){u&&(clearInterval(u),u=null)}document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState?v():g()}),v(),window.addEventListener("beforeunload",g),window.jytAnalytics={track:s,trackPageview:a,startHeartbeat:v,stopHeartbeat:g},console&&console.log&&(console.log("[Analytics] Initialized for website:",e),console.log("[Analytics] Heartbeat enabled (30s interval)"))}();